{#
# Copyright 2015 Google Inc.
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#}

{# [START form] #}
{% extends "base.html" %}
{% set active_page = "recommendation" %}

{% block content %}
<div class="container">
<h1 class="display-4">Our Recommendation</h1>
 <p class="lead">We are looking for the best plan combination that covers you{% if family.marital_status == 'married' and family.children|int > 0 %}, your spouse and your children{% elif family.marital_status == 'married' %} and your spouse{% elif family.children|int > 0 %} and your children{% endif %}.</p>
<br>
<div class="row">
	<div class="col-6"><h4>What is your expected healthcare utilization?</h4></div>
	<div class="col-6">
		<label class="custom-control custom-radio">
		  <input id="radio_low" name="utilization_radio" type="radio" class="custom-control-input utilization_radio"/>
		  <span class="custom-control-indicator"></span>
		  <span class="custom-control-description">Low</span>
		</label>
		<label class="custom-control custom-radio">
		  <input id="radio_med" name="utilization_radio" type="radio" class="custom-control-input utilization_radio" checked/>
		  <span class="custom-control-indicator"></span>
		  <span class="custom-control-description">Medium</span>
		</label>
		<label class="custom-control custom-radio">
		  <input id="radio_high" name="utilization_radio" type="radio" class="custom-control-input utilization_radio">
		  <span class="custom-control-indicator"></span>
		  <span class="custom-control-description">High</span>
		</label>
	</div>
</div>
<br>
<div class="rec-row hidden-xl-down">
<h4>Our Recommendation</h4>
</div>
{% for util in ['low', 'med', 'high'] %}
<div class="recommendation-text recommendation-text-{{util}} hidden-xl-down">
<p>{{recommendation[util].text}}</p>
</div>
{% endfor %}
<br>
<div class="options-row hidden-xl-down">
<h4>Your best options</h4>
</div>
{% for util in ['low', 'med', 'high'] %}
<div class="options options-{{util}} hidden-xl-down">
<table class="table table-hover options-table">
  <thead>
    <tr>
      <th>Option</th>
      <th>Price</th>
      <th>Expected Cost</th>
      <th>Saving</th>
    </tr>
  </thead>
  <tbody>
  {% for option in options[util] %}
    <tr {% if option['recommended'] %}class="table-success" {% endif %}>
      <td>{{option.text}}</td>
      <td>${{option.price|round(2, 'ceil')}}</td>
      <td>${{option.cost|round(2, 'ceil')}}</td>
      <td>${{option.savings|round(2, 'ceil')}}</td>
    </tr>
{% endfor %}    
  </tbody>
</table>
</div>
{% endfor %}
<br>
</div>
<script type="text/javascript">

  $(document).ready(function() {

    $('.options-table').DataTable({
    	searching: false,
    	paging: false,
    	info: false,
    	"order": [[ 2, 'asc' ]]});

  	$(".utilization_radio").click(function(){
  		update_utilization(this);
  	});

	var selected = $("input[type='radio'][name='utilization_radio']:checked");
	if (selected.length > 0) {update_utilization(selected[0])}
  });
  
  function update_utilization(radio_element) {
	$(".rec-row").removeClass('hidden-xl-down')
	$(".options-row").removeClass('hidden-xl-down')
	$(".recommendation-text").addClass('hidden-xl-down')
	$(".options").addClass('hidden-xl-down')
  	utilization = radio_element.id;
  	if (utilization == 'radio_low') {
  		$(".recommendation-text-low").removeClass('hidden-xl-down')
  		$(".options-low").removeClass('hidden-xl-down')
  	}
  	else if (utilization == 'radio_med') {
  		$(".recommendation-text-med").removeClass('hidden-xl-down')
  		$(".options-med").removeClass('hidden-xl-down')
  	}
  	else if (utilization == 'radio_high') {
  		$(".recommendation-text-high").removeClass('hidden-xl-down')
  		$(".options-high").removeClass('hidden-xl-down')
  	}

  }

</script>
</div>
{% endblock %}
{# [END form] #}